{"ast":null,"code":"import _regeneratorRuntime from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/ritakosk/fso/bloglist-frontend/src/App.js\";\nimport React from 'react';\nimport Blog from './components/Blog';\nimport BlogForm from './components/BlogForm';\nimport blogService from './services/blogs';\nimport loginService from './services/login';\n\nvar App =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(App, _React$Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.handleTextFieldChange = function (event) {\n      _this.setState(_defineProperty({}, event.target.name, event.target.value));\n    };\n\n    _this.createBlog =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var blog;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n                _context.prev = 1;\n                _context.next = 4;\n                return blogService.create({\n                  title: _this.state.title,\n                  author: _this.state.author,\n                  url: _this.state.url\n                });\n\n              case 4:\n                blog = _context.sent;\n\n                _this.setState({\n                  blogs: _toConsumableArray(_this.state.blogs).concat([blog])\n                });\n\n                _this.setState({\n                  title: '',\n                  author: '',\n                  url: ''\n                });\n\n                _context.next = 13;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](1);\n\n                _this.setState({\n                  error: _context.t0\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    error: ''\n                  });\n                }, 5000);\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 9]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.login =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(event) {\n        var user;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                event.preventDefault();\n                _context2.prev = 1;\n                _context2.next = 4;\n                return loginService.login({\n                  username: _this.state.username,\n                  password: _this.state.password\n                });\n\n              case 4:\n                user = _context2.sent;\n                blogService.setToken(user.token);\n                window.localStorage.setItem('loggedInBlogUser', JSON.stringify(user));\n\n                _this.setState({\n                  username: '',\n                  password: '',\n                  user: user\n                });\n\n                _context2.next = 14;\n                break;\n\n              case 10:\n                _context2.prev = 10;\n                _context2.t0 = _context2[\"catch\"](1);\n\n                _this.setState({\n                  error: 'Username or password was incorrect.'\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    error: null\n                  });\n                }, 5000);\n\n              case 14:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[1, 10]]);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.logout = function () {\n      window.localStorage.removeItem('loggedInBlogUser');\n\n      _this.setState({\n        user: null\n      });\n    };\n\n    _this.state = {\n      blogs: [],\n      user: null,\n      username: '',\n      password: '',\n      error: '',\n      title: '',\n      author: '',\n      url: ''\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      blogService.getAll().then(function (blogs) {\n        return _this2.setState({\n          blogs: blogs\n        });\n      });\n      var loggedInBlogUser = window.localStorage.getItem('loggedInBlogUser');\n\n      if (loggedInBlogUser) {\n        var user = JSON.parse(loggedInBlogUser);\n        this.setState({\n          user: user\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.state.user === null) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 88\n          },\n          __self: this\n        }, React.createElement(\"h2\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 89\n          },\n          __self: this\n        }, \"Log in to application\"), React.createElement(\"form\", {\n          onSubmit: this.login,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91\n          },\n          __self: this\n        }, \"username:\", React.createElement(\"input\", {\n          type: \"text\",\n          name: \"username\",\n          value: this.state.username,\n          onChange: this.handleTextFieldChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 93\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100\n          },\n          __self: this\n        }, \"password:\", React.createElement(\"input\", {\n          type: \"password\",\n          name: \"password\",\n          value: this.state.password,\n          onChange: this.handleTextFieldChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 102\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 109\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110\n          },\n          __self: this\n        }, \"login\"))));\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, \"blogs\"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, this.state.user.name, \" logged in\", React.createElement(\"input\", {\n        type: \"button\",\n        value: \"logout\",\n        style: {\n          margin: 5\n        },\n        onClick: this.logout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      })), React.createElement(BlogForm, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }), this.state.blogs.map(function (blog) {\n        return React.createElement(Blog, {\n          key: blog._id,\n          blog: blog,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        });\n      }));\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nexport default App;","map":{"version":3,"sources":["/home/ritakosk/fso/bloglist-frontend/src/App.js"],"names":["React","Blog","BlogForm","blogService","loginService","App","props","handleTextFieldChange","event","setState","target","name","value","createBlog","preventDefault","create","title","state","author","url","blog","blogs","error","setTimeout","login","username","password","user","setToken","token","window","localStorage","setItem","JSON","stringify","logout","removeItem","getAll","then","loggedInBlogUser","getItem","parse","margin","map","_id","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport Blog from './components/Blog'\nimport BlogForm from './components/BlogForm'\nimport blogService from './services/blogs'\nimport loginService from './services/login'\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      blogs: [],\n      user: null,\n      username: '',\n      password: '',\n      error: '',\n      title: '',\n      author: '',\n      url: ''\n    }\n  }\n\n  componentDidMount() {\n    blogService.getAll().then(blogs =>\n      this.setState({ blogs })\n    )\n\n    const loggedInBlogUser = window.localStorage.getItem('loggedInBlogUser')\n    if (loggedInBlogUser) {\n      const user = JSON.parse(loggedInBlogUser)\n      this.setState({ user })\n    }\n  }\n\n  handleTextFieldChange = (event) => {\n    this.setState({ [event.target.name]: event.target.value })\n  }\n\n  createBlog = async (event) => {\n    event.preventDefault()\n    try{\n      const blog = await blogService.create({\n       title: this.state.title,\n       author: this.state.author,\n       url: this.state.url\n      })\n\n      this.setState({ blogs:[...this.state.blogs, blog]})\n      this.setState({ title: '', author: '', url: '' })\n    } catch (exception) {\n      this.setState({\n        error: exception\n      })\n      setTimeout(() => {\n        this.setState({ error: '' })\n      }, 5000)\n    }\n  }\n\n  login = async (event) => {\n    event.preventDefault()\n    try{\n      const user = await loginService.login({\n        username: this.state.username,\n        password: this.state.password\n      })\n      blogService.setToken(user.token)      \n      window.localStorage.setItem('loggedInBlogUser', JSON.stringify(user))\n\n      this.setState({ username: '', password: '', user })\n    } catch (exception) {\n      this.setState({\n        error: 'Username or password was incorrect.'\n      })\n        setTimeout(() => {\n          this.setState({ error: null })\n        }, 5000)\n    }\n  }\n\n  logout = () => {\n    window.localStorage.removeItem('loggedInBlogUser')\n    this.setState({ user: null })\n  }\n\n  render() {\n    if (this.state.user === null) {\n      return (\n        <div>\n          <h2>Log in to application</h2>\n          <form onSubmit={this.login}>\n            <div>\n              username:\n              <input\n                type=\"text\"\n                name=\"username\"\n                value={this.state.username}\n                onChange={this.handleTextFieldChange}\n              />\n            </div>\n            <div>\n              password:\n              <input\n                type=\"password\"\n                name=\"password\"\n                value={this.state.password}\n                onChange={this.handleTextFieldChange}\n              />\n            </div>\n            <div>\n              <button type=\"submit\">login</button>\n            </div>\n          </form>\n        </div>\n      )\n    }\n    return (\n      <div>\n        <h2>blogs</h2>\n        <p>{this.state.user.name} logged in\n          <input type=\"button\" value=\"logout\" style={{margin: 5}} onClick={this.logout}/>\n        </p>\n\n        <BlogForm />\n\n        {this.state.blogs.map(blog => \n          <Blog key={blog._id} blog={blog}/>\n        )}\n      </div>\n    )\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}