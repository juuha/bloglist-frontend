{"ast":null,"code":"import _regeneratorRuntime from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/ritakosk/fso/bloglist-frontend/src/App.js\";\nimport React from 'react';\nimport Blog from './components/Blog';\nimport Notification from './components/Notification';\nimport Togglable from './components/Togglable';\nimport BlogForm from './components/BlogForm';\nimport blogService from './services/blogs';\nimport loginService from './services/login';\nimport './index.css';\n\nvar App =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(App, _React$Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.handleTextFieldChange = function (event) {\n      _this.setState(_defineProperty({}, event.target.name, event.target.value));\n    };\n\n    _this.createBlog =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var blog;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n\n                _this.BlogForm.toggleVisibility();\n\n                _context.prev = 2;\n                _context.next = 5;\n                return blogService.create({\n                  title: _this.state.title,\n                  author: _this.state.author,\n                  url: _this.state.url\n                });\n\n              case 5:\n                blog = _context.sent;\n\n                _this.setState({\n                  message: \"a new blog '\".concat(blog.title, \"' by \").concat(blog.author, \" added\")\n                });\n\n                _this.setState({\n                  blogs: _toConsumableArray(_this.state.blogs).concat([blog])\n                });\n\n                _this.setState({\n                  title: '',\n                  author: '',\n                  url: ''\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    message: null\n                  });\n                }, 5000);\n                _context.next = 16;\n                break;\n\n              case 12:\n                _context.prev = 12;\n                _context.t0 = _context[\"catch\"](2);\n\n                _this.setState({\n                  error: 'Missing either title or url'\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    error: null\n                  });\n                }, 5000);\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[2, 12]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.deleteBlog =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(blog) {\n        var updatedBlogs;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return blogService.remove(blog._id);\n\n              case 3:\n                _this.setState({\n                  message: \"Blog deleted successfully.\"\n                });\n\n                updatedBlogs = _this.state.blogs.filter(function (b) {\n                  return b._id !== blog._id;\n                });\n\n                _this.setState({\n                  blogs: updatedBlogs\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    message: null\n                  });\n                }, 5000);\n                _context2.next = 13;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](0);\n\n                _this.setState({\n                  error: 'Something went wrong.'\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    error: null\n                  });\n                }, 5000);\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[0, 9]]);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.addLike =\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(blog) {\n        var likedBlog;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                _context3.next = 3;\n                return blogService.update({\n                  likes: blog.likes,\n                  author: blog.author,\n                  title: blog.title,\n                  url: blog.url\n                }, blog._id);\n\n              case 3:\n                likedBlog = _context3.sent;\n\n                _this.setState({\n                  message: \"Blog '\".concat(likedBlog.title, \"' has been liked.\")\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    message: null\n                  });\n                }, 5000);\n                _context3.next = 12;\n                break;\n\n              case 8:\n                _context3.prev = 8;\n                _context3.t0 = _context3[\"catch\"](0);\n\n                _this.setState({\n                  error: 'Something went wrong..'\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    error: null\n                  });\n                }, 5000);\n\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[0, 8]]);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    _this.login =\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(event) {\n        var user;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                event.preventDefault();\n                _context4.prev = 1;\n                _context4.next = 4;\n                return loginService.login({\n                  username: _this.state.username,\n                  password: _this.state.password\n                });\n\n              case 4:\n                user = _context4.sent;\n                console.log(JSON.stringify(user));\n                blogService.setToken(user.token);\n                window.localStorage.setItem('loggedInBlogUser', JSON.stringify(user));\n\n                _this.setState({\n                  username: '',\n                  password: '',\n                  user: user,\n                  message: \"Logged in as \".concat(user.username)\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    message: null\n                  });\n                }, 5000);\n                _context4.next = 16;\n                break;\n\n              case 12:\n                _context4.prev = 12;\n                _context4.t0 = _context4[\"catch\"](1);\n\n                _this.setState({\n                  error: 'Wrong username or password.'\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    error: null\n                  });\n                }, 5000);\n\n              case 16:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[1, 12]]);\n      }));\n\n      return function (_x4) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    _this.logout = function () {\n      window.localStorage.removeItem('loggedInBlogUser');\n\n      _this.setState({\n        user: null,\n        message: \"Logged out.\"\n      });\n    };\n\n    _this.state = {\n      blogs: [],\n      user: null,\n      username: '',\n      password: '',\n      title: '',\n      author: '',\n      url: '',\n      error: null,\n      message: null\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      blogService.getAll().then(function (blogs) {\n        return _this2.setState({\n          blogs: blogs\n        });\n      });\n      var loggedInBlogUser = window.localStorage.getItem('loggedInBlogUser');\n\n      if (loggedInBlogUser) {\n        var user = JSON.parse(loggedInBlogUser);\n        this.setState({\n          user: user\n        });\n        blogService.setToken(user.token);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var user = JSON.parse(window.localStorage.getItem('loggedInBlogUser'));\n\n      if (user === null) {\n        return React.createElement(\"div\", {\n          className: \"notLogged\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152\n          },\n          __self: this\n        }, React.createElement(Notification, {\n          error: this.state.error,\n          message: this.state.message,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        }), React.createElement(\"h2\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, \"Log in to application\"), React.createElement(\"form\", {\n          onSubmit: this.login,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, \"username:\", React.createElement(\"input\", {\n          type: \"text\",\n          name: \"username\",\n          value: this.state.username,\n          onChange: this.handleTextFieldChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 158\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165\n          },\n          __self: this\n        }, \"password:\", React.createElement(\"input\", {\n          type: \"password\",\n          name: \"password\",\n          value: this.state.password,\n          onChange: this.handleTextFieldChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 174\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175\n          },\n          __self: this\n        }, \"login\"))));\n      }\n\n      return React.createElement(\"div\", {\n        className: \"logged\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, \"blogs\"), React.createElement(Notification, {\n        error: this.state.error,\n        message: this.state.message,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, user, \" logged in\", React.createElement(\"input\", {\n        type: \"button\",\n        value: \"logout\",\n        style: {\n          margin: 5\n        },\n        onClick: this.logout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      })), React.createElement(Togglable, {\n        buttonLabel: \"new blog\",\n        ref: function ref(component) {\n          return _this3.BlogForm = component;\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }, React.createElement(BlogForm, {\n        onSubmit: this.createBlog,\n        title: this.state.title,\n        author: this.state.author,\n        url: this.state.url,\n        handleChange: this.handleTextFieldChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      })), this.state.blogs.sort(function (a, b) {\n        return b.likes - a.likes;\n      }).map(function (blog) {\n        return React.createElement(Blog, {\n          key: blog._id,\n          blog: blog,\n          addLike: _this3.addLike,\n          deleteBlog: _this3.deleteBlog,\n          user: user,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 200\n          },\n          __self: this\n        });\n      }));\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nexport default App;","map":{"version":3,"sources":["/home/ritakosk/fso/bloglist-frontend/src/App.js"],"names":["React","Blog","Notification","Togglable","BlogForm","blogService","loginService","App","props","handleTextFieldChange","event","setState","target","name","value","createBlog","preventDefault","toggleVisibility","create","title","state","author","url","blog","message","blogs","setTimeout","error","deleteBlog","remove","_id","updatedBlogs","filter","b","addLike","update","likes","likedBlog","login","username","password","user","console","log","JSON","stringify","setToken","token","window","localStorage","setItem","logout","removeItem","getAll","then","loggedInBlogUser","getItem","parse","margin","component","sort","a","map","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport Blog from './components/Blog'\nimport Notification from './components/Notification'\nimport Togglable from './components/Togglable'\nimport BlogForm from './components/BlogForm'\nimport blogService from './services/blogs'\nimport loginService from './services/login'\nimport './index.css'\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      blogs: [],\n      user: null,\n      username: '',\n      password: '',\n      title: '',\n      author: '',\n      url: '',\n      error: null,\n      message: null\n    }\n  }\n\n  componentDidMount() {\n    blogService.getAll().then(blogs =>\n      this.setState({ blogs })\n    )\n\n    const loggedInBlogUser = window.localStorage.getItem('loggedInBlogUser')\n    if (loggedInBlogUser) {\n      const user = JSON.parse(loggedInBlogUser)\n      this.setState({ user })\n      blogService.setToken(user.token)\n    }\n  }\n\n  handleTextFieldChange = (event) => {\n    this.setState({ [event.target.name]: event.target.value })\n  }\n\n  createBlog = async (event) => {\n    event.preventDefault()\n    this.BlogForm.toggleVisibility()\n    try{\n      const blog = await blogService.create({\n       title: this.state.title,\n       author: this.state.author,\n       url: this.state.url\n      })\n\n      this.setState({ message: `a new blog '${blog.title}' by ${blog.author} added` })\n      this.setState({ blogs:[...this.state.blogs, blog]})\n      this.setState({ title: '', author: '', url: '' })\n      setTimeout(() => {\n        this.setState({ message: null })\n      }, 5000)\n    } catch (exception) {\n      this.setState({\n        error: 'Missing either title or url'\n      })\n      setTimeout(() => {\n        this.setState({ error: null })\n      }, 5000)\n    }\n  }\n\n  deleteBlog = async (blog) => {\n    try{\n      await blogService.remove(blog._id)\n      this.setState({ message: \"Blog deleted successfully.\" })\n      const updatedBlogs = this.state.blogs.filter(b => b._id !== blog._id)\n      this.setState({\n        blogs: updatedBlogs\n      })\n      setTimeout(() => {\n        this.setState({ message: null })\n      }, 5000)\n    } catch (exception) {\n      this.setState({\n        error: 'Something went wrong.'\n      })\n      setTimeout(() => {\n        this.setState({ error: null })\n      }, 5000)\n    }\n  }\n\n  addLike = async (blog) => {\n    try{\n      const likedBlog = await blogService.update({\n        likes: blog.likes,\n        author: blog.author,\n        title: blog.title,\n        url: blog.url\n      }, blog._id)\n      \n\n      this.setState({ message: `Blog '${likedBlog.title}' has been liked.` })\n      setTimeout(() => {\n        this.setState({ message: null })\n      }, 5000)\n    } catch (exception) {\n      this.setState({\n        error: 'Something went wrong..'\n      })\n      setTimeout(() => {\n        this.setState({ error: null })\n      }, 5000)\n    }\n  }\n\n  login = async (event) => {\n    event.preventDefault()\n    try{\n      const user = await loginService.login({\n        username: this.state.username,\n        password: this.state.password\n      })\n      console.log(JSON.stringify(user))\n      blogService.setToken(user.token)\n      window.localStorage.setItem('loggedInBlogUser', JSON.stringify(user))\n\n      this.setState({ username: '', password: '', user, message: `Logged in as ${user.username}` })\n      setTimeout(() => {\n        this.setState({ message: null })\n      }, 5000)\n    } catch (exception) {\n      this.setState({\n        error: 'Wrong username or password.'\n      })\n      setTimeout(() => {\n        this.setState({ error: null })\n      }, 5000)\n    }\n  }\n\n  logout = () => {\n    window.localStorage.removeItem('loggedInBlogUser')\n    this.setState({ \n      user: null,\n      message: \"Logged out.\"\n    })\n  }\n\n  render() {\n    const user = JSON.parse(window.localStorage.getItem('loggedInBlogUser'))\n\n    if (user === null) {\n      return (\n        <div className=\"notLogged\">\n          <Notification error={this.state.error} message={this.state.message} />\n          <h2>Log in to application</h2>\n          <form onSubmit={this.login}>\n            <div>\n              username:\n              <input\n                type=\"text\"\n                name=\"username\"\n                value={this.state.username}\n                onChange={this.handleTextFieldChange}\n              />\n            </div>\n            <div>\n              password:\n              <input\n                type=\"password\"\n                name=\"password\"\n                value={this.state.password}\n                onChange={this.handleTextFieldChange}\n              />\n            </div>\n            <div>\n              <button type=\"submit\">login</button>\n            </div>\n          </form>\n        </div>\n      )\n    }\n    return (\n      <div className=\"logged\">\n        <h2>blogs</h2>\n        <Notification error={this.state.error} message={this.state.message} />\n        <p>{user} logged in\n          <input type=\"button\" value=\"logout\" style={{margin: 5}} onClick={this.logout}/>\n        </p>\n\n        <Togglable buttonLabel=\"new blog\" ref={ component => this.BlogForm = component }>\n          <BlogForm \n            onSubmit={this.createBlog}\n            title={this.state.title}\n            author={this.state.author}\n            url={this.state.url}\n            handleChange={this.handleTextFieldChange}\n          />\n        </Togglable>\n\n        {this.state.blogs.sort((a, b) => b.likes - a.likes).map(blog => \n          <Blog \n            key={blog._id} \n            blog={blog} \n            addLike={this.addLike}\n            deleteBlog={this.deleteBlog}\n            user={user}\n          />\n        )}\n      </div>\n    )\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}