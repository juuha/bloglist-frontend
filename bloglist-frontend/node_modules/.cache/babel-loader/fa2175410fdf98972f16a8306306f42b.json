{"ast":null,"code":"import _regeneratorRuntime from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/ritakosk/fso/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/ritakosk/fso/bloglist-frontend/src/App.js\";\nimport React from 'react';\nimport Blog from './components/Blog';\nimport Notification from './components/Notification';\nimport Togglable from './components/Togglable';\nimport BlogForm from './components/BlogForm';\nimport blogService from './services/blogs';\nimport loginService from './services/login';\nimport './index.css';\n\nvar App =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(App, _React$Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.handleTextFieldChange = function (event) {\n      _this.setState(_defineProperty({}, event.target.name, event.target.value));\n    };\n\n    _this.createBlog =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var blog;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n\n                _this.BlogForm.toggleVisibility();\n\n                _context.prev = 2;\n                _context.next = 5;\n                return blogService.create({\n                  title: _this.state.title,\n                  author: _this.state.author,\n                  url: _this.state.url\n                });\n\n              case 5:\n                blog = _context.sent;\n\n                _this.setState({\n                  message: \"a new blog '\".concat(blog.title, \"' by \").concat(blog.author, \" added\")\n                });\n\n                _this.setState({\n                  blogs: _toConsumableArray(_this.state.blogs).concat([blog])\n                });\n\n                _this.setState({\n                  title: '',\n                  author: '',\n                  url: ''\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    message: null\n                  });\n                }, 5000);\n                _context.next = 16;\n                break;\n\n              case 12:\n                _context.prev = 12;\n                _context.t0 = _context[\"catch\"](2);\n\n                _this.setState({\n                  error: 'Missing either title or url'\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    error: null\n                  });\n                }, 5000);\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[2, 12]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.addLike =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(blog) {\n        var likedBlog;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return blogService.update({\n                  likes: blog.likes + 1,\n                  author: blog.author,\n                  title: blog.title,\n                  url: blog.url\n                }, blog._id);\n\n              case 3:\n                likedBlog = _context2.sent;\n\n                _this.setState({\n                  message: \"Blog \".concat(likedBlog.title, \" has been liked.\")\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    message: null\n                  });\n                }, 5000);\n                _context2.next = 12;\n                break;\n\n              case 8:\n                _context2.prev = 8;\n                _context2.t0 = _context2[\"catch\"](0);\n\n                _this.setState({\n                  error: 'Something went wrong..'\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    error: null\n                  });\n                }, 5000);\n\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[0, 8]]);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.login =\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(event) {\n        var user;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                event.preventDefault();\n                _context3.prev = 1;\n                _context3.next = 4;\n                return loginService.login({\n                  username: _this.state.username,\n                  password: _this.state.password\n                });\n\n              case 4:\n                user = _context3.sent;\n                blogService.setToken(user.token);\n                window.localStorage.setItem('loggedInBlogUser', JSON.stringify(user));\n\n                _this.setState({\n                  username: '',\n                  password: '',\n                  user: user,\n                  message: \"Logged in as \".concat(user.username)\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    message: null\n                  });\n                }, 5000);\n                _context3.next = 15;\n                break;\n\n              case 11:\n                _context3.prev = 11;\n                _context3.t0 = _context3[\"catch\"](1);\n\n                _this.setState({\n                  error: 'Wrong username or password.'\n                });\n\n                setTimeout(function () {\n                  _this.setState({\n                    error: null\n                  });\n                }, 5000);\n\n              case 15:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[1, 11]]);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    _this.logout = function () {\n      window.localStorage.removeItem('loggedInBlogUser');\n\n      _this.setState({\n        user: null,\n        message: \"Logged out.\"\n      });\n    };\n\n    _this.state = {\n      blogs: [],\n      user: null,\n      username: '',\n      password: '',\n      title: '',\n      author: '',\n      url: '',\n      error: null,\n      message: null\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      blogService.getAll().then(function (blogs) {\n        return _this2.setState({\n          blogs: blogs\n        });\n      });\n      var loggedInBlogUser = window.localStorage.getItem('loggedInBlogUser');\n\n      if (loggedInBlogUser) {\n        var user = JSON.parse(loggedInBlogUser);\n        this.setState({\n          user: user\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      if (this.state.user === null) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        }, React.createElement(Notification, {\n          error: this.state.error,\n          message: this.state.message,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127\n          },\n          __self: this\n        }), React.createElement(\"h2\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128\n          },\n          __self: this\n        }, \"Log in to application\"), React.createElement(\"form\", {\n          onSubmit: this.login,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        }, \"username:\", React.createElement(\"input\", {\n          type: \"text\",\n          name: \"username\",\n          value: this.state.username,\n          onChange: this.handleTextFieldChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        }, \"password:\", React.createElement(\"input\", {\n          type: \"password\",\n          name: \"password\",\n          value: this.state.password,\n          onChange: this.handleTextFieldChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 148\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149\n          },\n          __self: this\n        }, \"login\"))));\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, \"blogs\"), React.createElement(Notification, {\n        error: this.state.error,\n        message: this.state.message,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, this.state.user.name, \" logged in\", React.createElement(\"input\", {\n        type: \"button\",\n        value: \"logout\",\n        style: {\n          margin: 5\n        },\n        onClick: this.logout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      })), React.createElement(Togglable, {\n        buttonLabel: \"new blog\",\n        ref: function ref(component) {\n          return _this3.BlogForm = component;\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, React.createElement(BlogForm, {\n        onSubmit: this.createBlog,\n        title: this.state.title,\n        author: this.state.author,\n        url: this.state.url,\n        handleChange: this.handleTextFieldChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      })), this.state.blogs.map(function (blog) {\n        return React.createElement(Blog, {\n          key: blog._id,\n          blog: blog,\n          addLike: _this3.addLike,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 174\n          },\n          __self: this\n        });\n      }));\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nexport default App;","map":{"version":3,"sources":["/home/ritakosk/fso/bloglist-frontend/src/App.js"],"names":["React","Blog","Notification","Togglable","BlogForm","blogService","loginService","App","props","handleTextFieldChange","event","setState","target","name","value","createBlog","preventDefault","toggleVisibility","create","title","state","author","url","blog","message","blogs","setTimeout","error","addLike","update","likes","_id","likedBlog","login","username","password","user","setToken","token","window","localStorage","setItem","JSON","stringify","logout","removeItem","getAll","then","loggedInBlogUser","getItem","parse","margin","component","map","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport Blog from './components/Blog'\nimport Notification from './components/Notification'\nimport Togglable from './components/Togglable'\nimport BlogForm from './components/BlogForm'\nimport blogService from './services/blogs'\nimport loginService from './services/login'\nimport './index.css'\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      blogs: [],\n      user: null,\n      username: '',\n      password: '',\n      title: '',\n      author: '',\n      url: '',\n      error: null,\n      message: null\n    }\n  }\n\n  componentDidMount() {\n    blogService.getAll().then(blogs =>\n      this.setState({ blogs })\n    )\n\n    const loggedInBlogUser = window.localStorage.getItem('loggedInBlogUser')\n    if (loggedInBlogUser) {\n      const user = JSON.parse(loggedInBlogUser)\n      this.setState({ user })\n    }\n  }\n\n  handleTextFieldChange = (event) => {\n    this.setState({ [event.target.name]: event.target.value })\n  }\n\n  createBlog = async (event) => {\n    event.preventDefault()\n    this.BlogForm.toggleVisibility()\n    try{\n      const blog = await blogService.create({\n       title: this.state.title,\n       author: this.state.author,\n       url: this.state.url\n      })\n\n      this.setState({ message: `a new blog '${blog.title}' by ${blog.author} added` })\n      this.setState({ blogs:[...this.state.blogs, blog]})\n      this.setState({ title: '', author: '', url: '' })\n      setTimeout(() => {\n        this.setState({ message: null })\n      }, 5000)\n    } catch (exception) {\n      this.setState({\n        error: 'Missing either title or url'\n      })\n      setTimeout(() => {\n        this.setState({ error: null })\n      }, 5000)\n    }\n  }\n\n  addLike = async (blog) => {\n    try{\n      const likedBlog = await blogService.update({\n        likes: blog.likes +1,\n        author: blog.author,\n        title: blog.title,\n        url: blog.url\n      }, blog._id)\n\n      this.setState({ message: `Blog ${likedBlog.title} has been liked.` })\n      setTimeout(() => {\n        this.setState({ message: null })\n      }, 5000)\n    } catch (exception) {\n      this.setState({\n        error: 'Something went wrong..'\n      })\n      setTimeout(() => {\n        this.setState({ error: null })\n      }, 5000)\n    }\n  }\n\n  login = async (event) => {\n    event.preventDefault()\n    try{\n      const user = await loginService.login({\n        username: this.state.username,\n        password: this.state.password\n      })\n      blogService.setToken(user.token)\n      window.localStorage.setItem('loggedInBlogUser', JSON.stringify(user))\n\n      this.setState({ username: '', password: '', user, message: `Logged in as ${user.username}` })\n      setTimeout(() => {\n        this.setState({ message: null })\n      }, 5000)\n    } catch (exception) {\n      this.setState({\n        error: 'Wrong username or password.'\n      })\n      setTimeout(() => {\n        this.setState({ error: null })\n      }, 5000)\n    }\n  }\n\n  logout = () => {\n    window.localStorage.removeItem('loggedInBlogUser')\n    this.setState({ \n      user: null,\n      message: \"Logged out.\"\n    })\n  }\n\n  render() {\n    if (this.state.user === null) {\n      return (\n        <div>\n          <Notification error={this.state.error} message={this.state.message} />\n          <h2>Log in to application</h2>\n          <form onSubmit={this.login}>\n            <div>\n              username:\n              <input\n                type=\"text\"\n                name=\"username\"\n                value={this.state.username}\n                onChange={this.handleTextFieldChange}\n              />\n            </div>\n            <div>\n              password:\n              <input\n                type=\"password\"\n                name=\"password\"\n                value={this.state.password}\n                onChange={this.handleTextFieldChange}\n              />\n            </div>\n            <div>\n              <button type=\"submit\">login</button>\n            </div>\n          </form>\n        </div>\n      )\n    }\n    return (\n      <div>\n        <h2>blogs</h2>\n        <Notification error={this.state.error} message={this.state.message} />\n        <p>{this.state.user.name} logged in\n          <input type=\"button\" value=\"logout\" style={{margin: 5}} onClick={this.logout}/>\n        </p>\n\n        <Togglable buttonLabel=\"new blog\" ref={ component => this.BlogForm = component }>\n          <BlogForm \n            onSubmit={this.createBlog}\n            title={this.state.title}\n            author={this.state.author}\n            url={this.state.url}\n            handleChange={this.handleTextFieldChange}\n          />\n        </Togglable>\n\n        {this.state.blogs.map(blog => \n          <Blog key={blog._id} blog={blog} addLike={this.addLike}/>\n        )}\n      </div>\n    )\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}